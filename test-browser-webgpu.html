<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rehydra - WebGPU vs WASM Benchmark</title>
  
  <!-- Import map to resolve subpath imports for browser -->
  <script type="importmap">
  {
    "imports": {
      "#storage": "./dist/utils/storage.browser.js",
      "#onnx-runtime": "./dist/ner/onnx-runtime.browser.js"
    }
  }
  </script>
  
  <style>
    :root {
      --bg: #0a0a0f;
      --surface: #12121a;
      --border: #2a2a3a;
      --text: #e4e4e7;
      --text-muted: #71717a;
      --accent: #6366f1;
      --accent-dim: #4f46e5;
      --success: #22c55e;
      --warning: #eab308;
      --error: #ef4444;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 2rem;
      line-height: 1.6;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--accent);
    }
    
    .subtitle {
      color: var(--text-muted);
      margin-bottom: 2rem;
      font-size: 0.875rem;
    }
    
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    .card-title {
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-muted);
      margin-bottom: 1rem;
    }
    
    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border);
    }
    
    .status-row:last-child {
      border-bottom: none;
    }
    
    .status-label {
      color: var(--text-muted);
    }
    
    .status-value {
      font-weight: 500;
    }
    
    .status-value.success { color: var(--success); }
    .status-value.warning { color: var(--warning); }
    .status-value.error { color: var(--error); }
    .status-value.pending { color: var(--text-muted); }
    
    .controls {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }
    
    button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      font-family: inherit;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    button:hover:not(:disabled) {
      background: var(--accent-dim);
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    button.secondary {
      background: var(--border);
    }
    
    button.secondary:hover:not(:disabled) {
      background: #3a3a4a;
    }
    
    .input-group {
      margin-bottom: 1rem;
    }
    
    .input-group label {
      display: block;
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    textarea {
      width: 100%;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 0.75rem;
      color: var(--text);
      font-family: inherit;
      font-size: 0.875rem;
      resize: vertical;
      min-height: 100px;
    }
    
    textarea:focus {
      outline: none;
      border-color: var(--accent);
    }
    
    select {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 0.5rem 1rem;
      color: var(--text);
      font-family: inherit;
      font-size: 0.875rem;
    }
    
    .results-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }
    
    @media (max-width: 600px) {
      .results-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .result-card {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 1rem;
    }
    
    .result-card.winner {
      border-color: var(--success);
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
    }
    
    .result-provider {
      font-weight: 600;
      font-size: 1rem;
    }
    
    .result-badge {
      font-size: 0.625rem;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      background: var(--success);
      color: white;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .result-time {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.25rem;
    }
    
    .result-unit {
      font-size: 0.875rem;
      color: var(--text-muted);
    }
    
    .result-details {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
    }
    
    .log-area {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 1rem;
      max-height: 300px;
      overflow-y: auto;
      font-size: 0.75rem;
      white-space: pre-wrap;
      word-break: break-all;
    }
    
    .log-entry {
      padding: 0.25rem 0;
      border-bottom: 1px solid var(--border);
    }
    
    .log-entry:last-child {
      border-bottom: none;
    }
    
    .log-time {
      color: var(--text-muted);
      margin-right: 0.5rem;
    }
    
    .log-info { color: var(--text); }
    .log-success { color: var(--success); }
    .log-warning { color: var(--warning); }
    .log-error { color: var(--error); }
    
    .comparison {
      text-align: center;
      padding: 1rem;
      background: var(--bg);
      border-radius: 6px;
      margin-top: 1rem;
    }
    
    .comparison-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--success);
    }
    
    .spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 0.5rem;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .results-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
    }
    
    .results-table th,
    .results-table td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    .results-table th {
      color: var(--text-muted);
      font-weight: 500;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .results-table td {
      font-variant-numeric: tabular-nums;
    }
    
    .results-table .winner-cell {
      color: var(--success);
      font-weight: 600;
    }
    
    .results-table .size-label {
      color: var(--text-muted);
      font-size: 0.75rem;
    }
    
    .faster { color: var(--success); }
    .slower { color: var(--error); }
  </style>
</head>
<body>
  <div class="container">
    <h1>Rehydra WebGPU vs WASM Benchmark</h1>
    <p class="subtitle">Compare NER inference performance across execution providers</p>
    
    <!-- Environment Status -->
    <div class="card">
      <div class="card-title">Environment</div>
      <div class="status-row">
        <span class="status-label">WebGPU</span>
        <span id="webgpu-status" class="status-value pending">Checking...</span>
      </div>
      <div class="status-row">
        <span class="status-label">WASM</span>
        <span id="wasm-status" class="status-value pending">Checking...</span>
      </div>
      <div class="status-row">
        <span class="status-label">Model</span>
        <span id="model-status" class="status-value pending">Not loaded</span>
      </div>
    </div>
    
    <!-- Test Configuration -->
    <div class="card">
      <div class="card-title">Test Configuration</div>
      <div class="input-group">
        <label>Text Size</label>
        <select id="text-size" onchange="updateTextPreview()">
          <option value="short">Short (~50 chars)</option>
          <option value="medium" selected>Medium (~500 chars)</option>
          <option value="long">Long (~2K chars)</option>
          <option value="custom">Custom</option>
        </select>
      </div>
      <div class="input-group">
        <label>Preview</label>
        <textarea id="test-text" readonly>Loading...</textarea>
      </div>
      <div class="input-group">
        <label>Iterations per size</label>
        <select id="iterations">
          <option value="1">1 (quick test)</option>
          <option value="3" selected>3</option>
          <option value="5">5</option>
          <option value="10">10</option>
        </select>
      </div>
      <div class="controls">
        <button id="btn-load" onclick="loadModels()">
          Load Models
        </button>
        <button id="btn-benchmark" onclick="runBenchmark()" disabled>
          Run Benchmark (Selected Size)
        </button>
        <button id="btn-benchmark-all" onclick="runAllBenchmarks()" disabled>
          Run All Sizes
        </button>
        <button id="btn-clear" class="secondary" onclick="clearLog()">
          Clear Log
        </button>
      </div>
    </div>
    
    <!-- Results -->
    <div class="card" id="results-card" style="display: none;">
      <div class="card-title">Results</div>
      
      <!-- Results Table -->
      <table class="results-table" id="results-table">
        <thead>
          <tr>
            <th>Text Size</th>
            <th>WASM (ms)</th>
            <th>WebGPU (ms)</th>
            <th>Winner</th>
            <th>Diff</th>
          </tr>
        </thead>
        <tbody id="results-tbody">
        </tbody>
      </table>
      
      <!-- Summary -->
      <div class="comparison" id="comparison" style="display: none;">
        <span id="comparison-text"></span>
        <div class="comparison-value" id="comparison-value"></div>
      </div>
    </div>
    
    <!-- Log -->
    <div class="card">
      <div class="card-title">Log</div>
      <div class="log-area" id="log"></div>
    </div>
  </div>

  <script type="module">
    // Test texts (matching Node.js benchmarks)
    const TEST_TEXTS = {
      short: 'Contact john@example.com for details.',
      
      medium: `Dear Mr. Smith,

Thank you for reaching out regarding your account inquiry. We have reviewed 
your request and found the following information:

Customer: John Smith
Email: john.smith@example.com
Phone: +1-555-123-4567
Account: DE89370400440532013000

Your order #ORD-2024-001234 has been processed. Please contact our support 
team at support@acme-corp.com if you have any questions.

Best regards,
Jane Doe
Customer Service
Acme Corporation
Berlin, Germany`,

      long: `CONFIDENTIAL - CUSTOMER SERVICE RECORD

Customer Information:
- Name: Dr. Hans Müller
- Email: hans.mueller@techcorp.de
- Phone: +49 30 12345678
- Mobile: +49 170 1234567
- Address: Friedrichstraße 123, 10117 Berlin, Germany

Account Details:
- IBAN: DE89370400440532013000
- BIC: COBADEFFXXX
- Credit Card: 4532-1234-5678-9012 (Visa)
- Customer ID: CUST-2024-789456

Order History:
1. Order #ORD-2024-001234 - Shipped to Berlin
2. Order #ORD-2024-001235 - Delivered to Munich
3. Order #ORD-2024-001236 - Processing

Support Contacts:
- Primary: support@techcorp.de
- Secondary: help@techcorp.de
- Emergency: +49 800 1234567

Internal Notes:
Spoke with customer regarding issue #CASE-2024-456789. Customer mentioned 
colleague Maria Schmidt (maria.schmidt@techcorp.de) may also need access. 
Previous agent John Doe handled initial request from IP 192.168.1.100.

Follow-up scheduled with Team Lead Sarah Johnson in Munich office.
Customer prefers contact via email to hans.mueller@techcorp.de.

Additional contacts provided:
- Work: hans.mueller@work.example.com
- Personal: hansm@personal.example.org
- Backup phone: +49 89 9876543

Payment Information:
- Alternative card: 5425-2334-3010-9903 (Mastercard)
- PayPal: hans.paypal@example.com

Location History:
- Frankfurt, Germany (2024-01)
- Paris, France (2024-02)
- London, United Kingdom (2024-03)

End of Record`
    };
    
    // State
    let wasmAnonymizer = null;
    let webgpuAnonymizer = null;
    let modelsLoaded = false;
    let allResults = {};
    
    // DOM elements
    const logEl = document.getElementById('log');
    const webgpuStatus = document.getElementById('webgpu-status');
    const wasmStatus = document.getElementById('wasm-status');
    const modelStatus = document.getElementById('model-status');
    const btnLoad = document.getElementById('btn-load');
    const btnBenchmark = document.getElementById('btn-benchmark');
    const btnBenchmarkAll = document.getElementById('btn-benchmark-all');
    
    // Update text preview
    window.updateTextPreview = function() {
      const size = document.getElementById('text-size').value;
      const textarea = document.getElementById('test-text');
      if (size === 'custom') {
        textarea.readOnly = false;
        textarea.value = textarea.value || 'Enter your custom text here...';
      } else {
        textarea.readOnly = true;
        textarea.value = TEST_TEXTS[size];
      }
    };
    
    // Initialize text preview
    setTimeout(() => updateTextPreview(), 0);
    
    // Logging utility
    function log(message, type = 'info') {
      const time = new Date().toLocaleTimeString();
      const entry = document.createElement('div');
      entry.className = `log-entry log-${type}`;
      entry.innerHTML = `<span class="log-time">[${time}]</span>${message}`;
      logEl.appendChild(entry);
      logEl.scrollTop = logEl.scrollHeight;
      console.log(`[${type}] ${message}`);
    }
    
    window.clearLog = function() {
      logEl.innerHTML = '';
    };
    
    // Check environment
    async function checkEnvironment() {
      // Check WebGPU
      if (navigator.gpu) {
        try {
          const adapter = await navigator.gpu.requestAdapter();
          if (adapter) {
            const info = await adapter.requestAdapterInfo?.() || {};
            webgpuStatus.textContent = `✓ Available (${info.vendor || 'GPU'})`;
            webgpuStatus.className = 'status-value success';
            log(`WebGPU available: ${info.description || info.vendor || 'GPU adapter found'}`, 'success');
          } else {
            webgpuStatus.textContent = '✗ No adapter';
            webgpuStatus.className = 'status-value error';
            log('WebGPU: No adapter available', 'warning');
          }
        } catch (e) {
          webgpuStatus.textContent = `✗ ${e.message}`;
          webgpuStatus.className = 'status-value error';
          log(`WebGPU error: ${e.message}`, 'error');
        }
      } else {
        webgpuStatus.textContent = '✗ Not supported';
        webgpuStatus.className = 'status-value error';
        log('WebGPU not supported in this browser', 'warning');
      }
      
      // WASM is always available in modern browsers
      wasmStatus.textContent = '✓ Available';
      wasmStatus.className = 'status-value success';
      log('WASM available', 'success');
    }
    
    // Load models
    window.loadModels = async function() {
      btnLoad.disabled = true;
      btnLoad.innerHTML = '<span class="spinner"></span>Loading...';
      modelStatus.textContent = 'Loading...';
      modelStatus.className = 'status-value pending';
      
      try {
        log('Importing Rehydra library...', 'info');
        const { createAnonymizer } = await import('./dist/browser.js');
        
        // Create WASM anonymizer
        log('Creating WASM anonymizer...', 'info');
        wasmAnonymizer = createAnonymizer({
          ner: {
            mode: 'quantized',
            autoDownload: true,
            sessionOptions: {
              executionProviders: ['wasm'],
            },
            onStatus: (status) => log(`[WASM] ${status}`, 'info'),
          }
        });
        
        log('Initializing WASM model (may download on first run)...', 'info');
        await wasmAnonymizer.initialize();
        log('WASM model loaded!', 'success');
        
        // Create WebGPU anonymizer (if available)
        if (navigator.gpu) {
          log('Creating WebGPU anonymizer...', 'info');
          webgpuAnonymizer = createAnonymizer({
            ner: {
              mode: 'quantized',
              autoDownload: false, // Already downloaded
              sessionOptions: {
                executionProviders: ['webgpu', 'wasm'],
              },
              onStatus: (status) => log(`[WebGPU] ${status}`, 'info'),
            }
          });
          
          log('Initializing WebGPU model...', 'info');
          await webgpuAnonymizer.initialize();
          log('WebGPU model loaded!', 'success');
        } else {
          log('Skipping WebGPU (not available)', 'warning');
        }
        
        modelsLoaded = true;
        modelStatus.textContent = '✓ Loaded';
        modelStatus.className = 'status-value success';
        btnBenchmark.disabled = false;
        btnBenchmarkAll.disabled = false;
        btnLoad.textContent = 'Models Loaded';
        
      } catch (e) {
        log(`Error loading models: ${e.message}`, 'error');
        console.error(e);
        modelStatus.textContent = `✗ ${e.message}`;
        modelStatus.className = 'status-value error';
        btnLoad.disabled = false;
        btnLoad.textContent = 'Retry Load';
      }
    };
    
    // Run single benchmark for selected size
    async function runBenchmarkForSize(sizeName, text, iterations) {
      log(`\n--- ${sizeName.toUpperCase()} (${text.length} chars) ---`, 'info');
      
      const results = { wasm: [], webgpu: [] };
      
      // Warmup
      if (wasmAnonymizer) await wasmAnonymizer.anonymize(text);
      if (webgpuAnonymizer) await webgpuAnonymizer.anonymize(text);
      
      // WASM benchmark
      if (wasmAnonymizer) {
        log(`[WASM] Running...`, 'info');
        for (let i = 0; i < iterations; i++) {
          const start = performance.now();
          await wasmAnonymizer.anonymize(text);
          results.wasm.push(performance.now() - start);
        }
        const avg = results.wasm.reduce((a, b) => a + b, 0) / results.wasm.length;
        log(`[WASM] Average: ${avg.toFixed(1)}ms`, 'info');
      }
      
      // WebGPU benchmark
      if (webgpuAnonymizer) {
        log(`[WebGPU] Running...`, 'info');
        for (let i = 0; i < iterations; i++) {
          const start = performance.now();
          await webgpuAnonymizer.anonymize(text);
          results.webgpu.push(performance.now() - start);
        }
        const avg = results.webgpu.reduce((a, b) => a + b, 0) / results.webgpu.length;
        log(`[WebGPU] Average: ${avg.toFixed(1)}ms`, 'info');
      }
      
      // Calculate stats
      const stats = {};
      for (const [provider, times] of Object.entries(results)) {
        if (times.length > 0) {
          stats[provider] = {
            avg: times.reduce((a, b) => a + b, 0) / times.length,
            min: Math.min(...times),
            max: Math.max(...times),
          };
        }
      }
      
      return stats;
    }
    
    // Run benchmark for selected size
    window.runBenchmark = async function() {
      if (!modelsLoaded) {
        log('Please load models first', 'warning');
        return;
      }
      
      const size = document.getElementById('text-size').value;
      const text = document.getElementById('test-text').value;
      const iterations = parseInt(document.getElementById('iterations').value);
      
      btnBenchmark.disabled = true;
      btnBenchmarkAll.disabled = true;
      btnBenchmark.innerHTML = '<span class="spinner"></span>Running...';
      
      log(`\n${'='.repeat(50)}`, 'info');
      log(`Benchmark: ${size} text, ${iterations} iterations`, 'info');
      log(`${'='.repeat(50)}`, 'info');
      
      const stats = await runBenchmarkForSize(size, text, iterations);
      allResults = { [size]: stats };
      
      displayResults();
      
      log('\n' + '='.repeat(50), 'info');
      log('Benchmark complete!', 'success');
      
      btnBenchmark.disabled = false;
      btnBenchmarkAll.disabled = false;
      btnBenchmark.textContent = 'Run Benchmark (Selected Size)';
    };
    
    // Run all benchmarks
    window.runAllBenchmarks = async function() {
      if (!modelsLoaded) {
        log('Please load models first', 'warning');
        return;
      }
      
      const iterations = parseInt(document.getElementById('iterations').value);
      
      btnBenchmark.disabled = true;
      btnBenchmarkAll.disabled = true;
      btnBenchmarkAll.innerHTML = '<span class="spinner"></span>Running all...';
      
      log(`\n${'='.repeat(50)}`, 'info');
      log(`Running ALL benchmarks: ${iterations} iterations each`, 'info');
      log(`${'='.repeat(50)}`, 'info');
      
      allResults = {};
      
      for (const [size, text] of Object.entries(TEST_TEXTS)) {
        allResults[size] = await runBenchmarkForSize(size, text, iterations);
      }
      
      displayResults();
      
      log('\n' + '='.repeat(50), 'info');
      log('All benchmarks complete!', 'success');
      
      btnBenchmark.disabled = false;
      btnBenchmarkAll.disabled = false;
      btnBenchmarkAll.textContent = 'Run All Sizes';
    };
    
    function displayResults() {
      const resultsCard = document.getElementById('results-card');
      const tbody = document.getElementById('results-tbody');
      const comparison = document.getElementById('comparison');
      
      resultsCard.style.display = 'block';
      tbody.innerHTML = '';
      
      const sizes = ['short', 'medium', 'long'];
      const sizeLabels = {
        short: 'Short (~50 chars)',
        medium: 'Medium (~500 chars)',
        long: 'Long (~2K chars)',
        custom: 'Custom'
      };
      
      let wasmTotal = 0, webgpuTotal = 0, count = 0;
      
      for (const size of sizes) {
        const stats = allResults[size];
        if (!stats) continue;
        
        const wasmAvg = stats.wasm?.avg;
        const webgpuAvg = stats.webgpu?.avg;
        
        let winner = '-';
        let diff = '-';
        let winnerClass = '';
        
        if (wasmAvg && webgpuAvg) {
          wasmTotal += wasmAvg;
          webgpuTotal += webgpuAvg;
          count++;
          
          if (wasmAvg < webgpuAvg) {
            winner = 'WASM';
            diff = `${((webgpuAvg / wasmAvg - 1) * 100).toFixed(0)}% faster`;
            winnerClass = 'faster';
          } else {
            winner = 'WebGPU';
            diff = `${((wasmAvg / webgpuAvg - 1) * 100).toFixed(0)}% faster`;
            winnerClass = 'faster';
          }
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>
            <strong>${size.charAt(0).toUpperCase() + size.slice(1)}</strong>
            <div class="size-label">${sizeLabels[size]}</div>
          </td>
          <td class="${winner === 'WASM' ? 'winner-cell' : ''}">${wasmAvg ? wasmAvg.toFixed(1) : 'N/A'}</td>
          <td class="${winner === 'WebGPU' ? 'winner-cell' : ''}">${webgpuAvg ? webgpuAvg.toFixed(1) : 'N/A'}</td>
          <td><strong>${winner}</strong></td>
          <td class="${winnerClass}">${diff}</td>
        `;
        tbody.appendChild(row);
      }
      
      // Also show custom if it exists
      if (allResults.custom) {
        const stats = allResults.custom;
        const wasmAvg = stats.wasm?.avg;
        const webgpuAvg = stats.webgpu?.avg;
        
        let winner = '-', diff = '-', winnerClass = '';
        if (wasmAvg && webgpuAvg) {
          if (wasmAvg < webgpuAvg) {
            winner = 'WASM';
            diff = `${((webgpuAvg / wasmAvg - 1) * 100).toFixed(0)}% faster`;
            winnerClass = 'faster';
          } else {
            winner = 'WebGPU';
            diff = `${((wasmAvg / webgpuAvg - 1) * 100).toFixed(0)}% faster`;
            winnerClass = 'faster';
          }
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><strong>Custom</strong></td>
          <td class="${winner === 'WASM' ? 'winner-cell' : ''}">${wasmAvg ? wasmAvg.toFixed(1) : 'N/A'}</td>
          <td class="${winner === 'WebGPU' ? 'winner-cell' : ''}">${webgpuAvg ? webgpuAvg.toFixed(1) : 'N/A'}</td>
          <td><strong>${winner}</strong></td>
          <td class="${winnerClass}">${diff}</td>
        `;
        tbody.appendChild(row);
      }
      
      // Overall comparison
      if (count > 0) {
        const comparisonText = document.getElementById('comparison-text');
        const comparisonValue = document.getElementById('comparison-value');
        
        if (wasmTotal < webgpuTotal) {
          comparisonText.textContent = 'Overall: WASM is faster by';
          comparisonValue.textContent = `${((webgpuTotal / wasmTotal - 1) * 100).toFixed(0)}%`;
        } else {
          comparisonText.textContent = 'Overall: WebGPU is faster by';
          comparisonValue.textContent = `${((wasmTotal / webgpuTotal - 1) * 100).toFixed(0)}%`;
        }
        comparison.style.display = 'block';
      } else {
        comparison.style.display = 'none';
      }
    }
    
    // Initialize
    checkEnvironment();
  </script>
</body>
</html>

